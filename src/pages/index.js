import React, { useEffect, useState } from "react";
import Head from "next/head";
import Link from "next/link";
import { signOut, useSession } from "next-auth/react";
import { useForm } from "react-hook-form";
import { getError } from "../utils/error";
import { toast, ToastContainer } from "react-toastify";
import "react-toastify/dist/ReactToastify.css";
import axios from "axios";
import PdfViewer from "@/components/PdfViewer";
import Navbar from "../components/Navbar/Navbar";
import Swiperr from "../components/Swiperr";

export default function Home() {
  const { data: session } = useSession();
  // console.log(session)

  const [pdfData, setPdfData] = useState(null);

  const {
    handleSubmit,
    register,
    watch,
    formState: { errors },
  } = useForm();

  // const filename = watch('filename')[0].name

  const onSubmit = async (data) => {
    const { title, author, course, filename } = data;
    const formData = new FormData();

    formData.append("file", filename[0]);
    formData.append("upload_preset", "file_upload");

    try {
      const response = await axios.post(
        "https://api.cloudinary.com/v1_1/dtfxgvzze/upload",
        formData
      );

      const filename = response.data.url;
      console.log(filename);
      const newProject = {
        title,
        author,
        course,
        filename,
      };

      await axios.post("/api/project", newProject);

      toast("project uploaded successfully");
    } catch (error) {
      console.log(error);
    }

    // for (const value of formData.values()) {
    //   console.log(value);
    // }

    // try {
    //   await axios.post("/api/project", formData, {
    //     headers: {
    //       'Content-Type': 'multipart/form-data'
    //     }});
    //   toast("project uploaded successfully");
    // } catch (err) {
    //   toast.error(getError(err));
    // }
    //   const res = await fetch("http://localhost:3000/api/project", {
    //     method: "POST",
    //     body: formData,
    // }).then((res) => res.json());
    // alert(JSON.stringify(`${res.message}, status: ${res.status}`));
  };

  // useEffect(() => {
  //   const fetchPdfData = async () => {
  //     try{
  //       const response = await fetch('http://localhost:3000/api/project');
  //       // response?.map()
  //       // setPdfData(pdfData);
  //     } catch (error) {
  //       console.log("failed to fetch pdf data", error);
  //     }
  //   }
  //   fetchPdfData();
  // }, []);

  return (
    <>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className="h-full w-full">
        <Navbar />
     
        <Swiperr />
        <section>
          <div className="bg-black text-white py-10 mt-5">
          <h1 className="text-center text-2xl mb-10 ">Library services</h1>
          <p className="text-xl mx-5 text-center">
            The University Library provides specialized online and offline
            services for all staff and students. We subscribed to the best of
            databases that provides researches with peered reviewed articles
            that impacts the quality of research output from the University
          </p>
          </div>
          <div>
            <h2 className="text-center text-2xl mb-10 mt-10">About us</h2>
            <p className="text-xl mx-5 text-center">
              The University Library provides access to numerous online and
              offline resources through subscription to renowned academic
              databases.State of heart technological facilities such as Learning
              Commons that aids effective teaching, learning and research are
              provided for users.
            </p>
          </div>
          <div className="mt-10">
          <div className="h-[50vh] w-full relative">
  <div className="h-full w-full relative">
    <img className="h-full w-full object-cover object-top" src="https://media.istockphoto.com/id/1314585958/photo/african-american-teacher-shows-cards-with-letters-to-screen.jpg?s=612x612&w=0&k=20&c=8kfLli1GgG9_xNwCgGd_22CDZNYPgTzsBXeo96zYHnQ=" alt="" />
    <div className="absolute top-0 left-0 w-full h-full bg-black opacity-50 z-10"></div>
  </div>
  <div className="w-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-20">
    <h1 className="text-2xl font-semibold text-white text-center">Technology Education</h1>
    <p className="text-xl font-mono text-white mt-10 text-center mx-5">
      We will serve you as long as you are able to pay for all our services okay you caught us in the right place at the right time thinking about the book of psalms where all our prodigal daughters can be properly accessed and assembled{" "}
    </p>
  </div>
</div>



            <div className="h-[50vh] w-full relative bg-rose-700 bg-opacity-30">
              {" "}
              <div className=" w-full mt-10   absolute">
                {" "}
                <h1 className="text-2xl font-semibold text-white text-center">Computer Science Education</h1>
                <p className="text-xl font-mono text-white mt-10 text-center mx-5">
                  We will serve you as long as you are able to pay for all our
                  services okay you caught us in the right place at the right
                  time thinking about the book of psalms where all our prodigal
                  daughters can be properly accessed and assembled{" "}
                </p>
              </div>{" "}
              <img
                className="h-full w-full object-cover object-top"
                src="https://media.istockphoto.com/id/1401177650/photo/young-girl-with-curly-hair-holding-books-in-her-hands-inside-the-library-cute-girl-doing.jpg?s=612x612&w=0&k=20&c=I6YukVQY4Q969vNEgjv5ZxvbxfO_SJq_hH5M3PoXYTo="
                alt=""
              />{" "}
            </div>
            <div className="h-[50vh] w-full relative bg-rose-700 bg-opacity-30">
              {" "}
              <div className=" w-full mt-10 absolute">
                {" "}
                <h1 className="text-2xl font-semibold text-white text-center mt-10">Educational Technology</h1>
                <p className="text-xl font-mono text-white mt-10 text-center mx-5">
                  We will serve you as long as you are able to pay for all our
                  services okay you caught us in the right place at the right
                  {" "}
                </p>
              </div>{" "}
              <img
                className="h-full w-full   object-cover object-top"
                src="https://media.istockphoto.com/id/1314585897/photo/black-lady-talks-to-schoolgirl-with-tablet-and-shows-photos.jpg?s=612x612&w=0&k=20&c=FXWmCOij2hs6sG16_yXWNXh9hiKemsmgHaHSFQB2FDM="
                alt=""
              />{" "}
            </div>
          </div>
        </section>
      </main>
      <p className="text-center font-mono font-semibold">Â© 2022 COMSAVVY</p>
    </>
  );
}
